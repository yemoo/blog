---
title: ES6学习笔记(2)：变量声明--ES6变量(let)与常量(const)  
date: 2016-05-05 01:46:48  
categories:
- 前端
tags: 
- es6
- ecmascript
- js
---

## ECMAScript 5

### var: 变量声明  
1. ES5中变量如果不使用`var` 声明（而直接使用）则默认为全局变量（隐式声明）。
```js
(function(){
    a=100;  // 没有使用 var 定义，因此是全局变量
})();
console.log(a);  // 100
```
2. 可以使用`var`声明为局部变量（ES5中局部变量作用域是函数级，不是块级~）。
```js
var a = 100;
(function(){
    var a = 10;
    console.log(a); // 10，因为a定义为局部变量 
})();
console.log(a); // 100，使用外部定义的变量a
```
3. `var`变量的值需要先赋值才能读取，可以声明任何类型变量，如字符串，数组，函数等。
```js
console.log(a);  // undefined
var a = 1; 
console.log(a); // 1
```
4. 变量提升：将变量声明提升到函数的顶部，但不会提升变量赋值。如：
```js
(function(){
    console.log(a);
    var a = 100;
    console.log(a);
})();
// 等同于
(function(){
    var a;
    console.log(a);
    a = 100;
    console.log(a);
})();
```

### function: 函数声明
1. 除了使用`var`做变量声明，还有一种特殊的变量声明：函数声明，通过`function`定义一个函数，相当于定义了一个函数变量，函数名可以同一般的变量名一样使用。
2. 函数变量不同于`var`变量：
  - 首先将整个函数定义提升到代码的顶部（类似于全局变量），因此可用先调用再声明的方式执行。
{% codeblock lang:js %}
a();  // 输出 test
function a(){
    console.log('test')
}
{% endcodeblock %}
{% codeblock lang:js %}
a();  // 报错：Uncaught TypeError: a is not a function
var a = function(){
    console.log('test');
};
{% endcodeblock %}
  - 虽然function 看起来像是全局变量声明（可以先读取调用再定义），但实际上函数声明是函数级的。
```js
function outer(){
    function inner(){
        console.log('inner');
    }
    console.log('outer');
}
outer(); // outer
inner(); // Uncaught ReferenceError: inner is not defined
```

## ECMAScript 6

### let: 块级变量声明
1. 块级作用域
  - 与`var`类似，但是`let`所声明的变量，只在其声明的代码块内有效。
```js
{
  let a = 10;
  var b = 1;
}
a // ReferenceError: a is not defined.
b // 1
```
  - 很适用于一些临时变量的场景，如 for 循环的计数变量。可解决以前需要通过闭包解决的循环变量值问题。
{% codeblock lang:js %}
for(let i = 0; i < arr.length; i++){
}
console.log(i);  //ReferenceError: i is not defined
{% endcodeblock %}
{% codeblock lang:js %}
// 使用 var 变量
var a = [];
for (var i = 0; i < 10; i++) {
  a[i] = function () {
    console.log(i);
  };
}
a[6](); // 10
// 解决办法
// 将4-6行代码换为
// a[i] = (function(i){
//    return function () {
//        console.log(i);
//    };
// })(i);
{% endcodeblock %}
{% codeblock lang:js %}
// 使用 let 变量
var a = [];
for (let i = 0; i < 10; i++) {
  a[i] = function () {
    console.log(i);
  };
}
a[6](); // 6
{% endcodeblock %}
2. 无变量提升
 - 暂时性死区
 - 使用必须在声明后
3. 不可重复声明

### const: 常量声明
1. 定义后值不可修改
2. 引用类型的常量
3. 块级作用域
4. 不可重复声明

### 跨模块变量

### 全局变量